# Trimiata bot

## env vars для приложения
* `TELEGRAM_TOKEN`
* `STOCK_DATA_EQUIVALENCE`
* `1C_LOGIN`
* `1C_PASSWORD`
* `SRC_PATH`
* `DST_PATH`

## Для монтирования волюмов
* `SRC_PATH`
* `DST_PATH`

## docker
* `docker build -t trim_bot:0 .`
* `docker run -d --name trim_bot --restart=always --env-file .env -v /mnt/PHOTO_SOURCES:/mnt/PHOTO_SOURCES trim_bot:0`

## Функции
* `/stock_data_equivalence` - делает запрос к 1С, получает данные о результатах сверки без предварительного запроса к сайту
* `/stock_data_equivalence_update` - делает запрос к 1С, получает данные о результатах сверки с предварительным запросом к сайту
* `/find_photos_with_same_article` - в папке `/SOURCES/PHOTO` собирает уникальные штрихкоды, подтягивает их артикулы и если есть одинаковые артикулы для разных штрихкодов, то собираются все фотографии содержащие эти штрихкоды и подготавливает отчет
* `/rename_photos` - переименовывает sources в renamed. До операции проверяет корректность файлов, если есть ошибки, то не будет делать переменование.
* `/rename_videos` - переименовывает sources в renamed. До операции проверяет корректность файлов, если есть ошибки, то не будет делать переменование.
* `/accept_photos` - делает приемку фото
* `/accept_videos` - делает приемку видео

## Запуск
1. Файл .env в корне проекта используется для локального запуска приложения (без докера)
2. Для запуска в контейнере файл .env нужно поместить в директорию infra/ откуда докер возьмет переменные для установки внутри конейтнера, а так же для монтирования волюмов.